# å®Œæ•´å¼€å‘å·¥ä½œæµç¨‹æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†ä»ä»£ç ç¼–å†™åˆ°æˆåŠŸæäº¤çš„å®Œæ•´å·¥ç¨‹åŒ–å·¥ä½œæµç¨‹ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€è§„èŒƒæ€§å’Œå›¢é˜Ÿåä½œæ•ˆç‡ã€‚

## ğŸ—ï¸ å·¥ç¨‹åŒ–æ¶æ„

### æ ¸å¿ƒç»„ä»¶

- **ESLint** - ä»£ç è¯­æ³•å’Œè§„èŒƒæ£€æŸ¥
- **Prettier** - ä»£ç æ ¼å¼åŒ–
- **Husky** - Git Hooks ç®¡ç†
- **lint-staged** - æš‚å­˜æ–‡ä»¶æ£€æŸ¥
- **commitlint** - æäº¤ä¿¡æ¯éªŒè¯
- **TypeScript** - ç±»å‹æ£€æŸ¥

### å·¥ä½œæµç¨‹æ¶æ„å›¾

```
å¼€å‘è€…ç¼–ç 
    â†“
ä¿å­˜æ–‡ä»¶ (è‡ªåŠ¨æ ¼å¼åŒ– + ESLintæ£€æŸ¥)
    â†“
Git Add (lint-stagedè‡ªåŠ¨æ£€æŸ¥æš‚å­˜æ–‡ä»¶)
    â†“
Git Commit (commitlintéªŒè¯æäº¤ä¿¡æ¯)
    â†“
Git Push (è§¦å‘CI/CD)
```

## ğŸ”§ é…ç½®ç»“æ„

### 1. é…ç½®æ–‡ä»¶å±‚çº§

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ .eslintrc.js           # ESLinté…ç½®ï¼ˆå·²åˆ é™¤ï¼Œä½¿ç”¨eslint.config.jsï¼‰
â”œâ”€â”€ eslint.config.js       # æ–°ç‰ˆESLinté…ç½®ã€‚
â”œâ”€â”€ .prettierrc            # Prettieré…ç½®ã€‚
â”œâ”€â”€ .commitlintrc.js       # commitlinté…ç½®
â”œâ”€â”€ package.json           # npmè„šæœ¬å’Œlint-stagedé…ç½®ã€‚
â”œâ”€â”€ .husky/                # Git Hooksç›®å½•ã€‚
â”‚   â”œâ”€â”€ pre-commit         # æäº¤å‰æ£€æŸ¥ã€‚
â”‚   â””â”€â”€ commit-msg         # æäº¤ä¿¡æ¯éªŒè¯ã€‚
â””â”€â”€ .vscode/               # VS Codeé…ç½®
    â”œâ”€â”€ settings.json      # ç¼–è¾‘å™¨è®¾ç½®
    â””â”€â”€ extensions.json    # æ¨èæ‰©å±•
```

### 2. é…ç½®æ–‡ä»¶è¯´æ˜

### 2.1 ESLint é…ç½® (eslint.config.js)

- ä½¿ç”¨ `npm init @eslint/config `åˆå§‹åŒ–é…ç½®æ–‡ä»¶ã€‚

```javascript
// æ”¯æŒTypeScript + JavaScript
// å®æ—¶æç¤ºå’Œè‡ªåŠ¨ä¿®å¤
// è‡ªå®šä¹‰è§„åˆ™é›†
```

### 2.2 Husky é…ç½®

- **pre-commit**: è¿è¡Œ ESLint + Prettier æ£€æŸ¥ã€‚å‘½ä»¤ï¼šnpx husky add .husky/pre-commit 'npx lint-staged'ã€‚ä¿®æ”¹é»˜è®¤çš„pre-commité’©å­ï¼ˆå®˜æ–¹ç”Ÿæˆçš„æ˜¯npm testï¼Œæ›¿æ¢ä¸º lint-stagedï¼‰ï¼šnpx lint-staged
- **commit-msg**: éªŒè¯æäº¤ä¿¡æ¯æ ¼å¼ã€‚å‘½ä»¤ï¼šnpx husky add .husky/commit-msg 'npx commitlint --edit $1'

### 2.3 Prettier é…ç½®

```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80
}
```

- æ³¨æ„ï¼šåœ¨eslint.config.jsä¸­æ·»åŠ  Prettier æ’ä»¶

### 2.4 commitlint é…ç½®ã€‚package.json è„šæœ¬å’Œ lint-staged é…ç½®

å‚è€ƒï¼š<mcfile name="package.json" path="c:\Users\xmm\studioProjects\flutter_ex1_back\package.json" startline="20" endline="40"></mcfile>

```json

  "lint-staged": {
    "*.{ts,js,tsx,jsx}": ["eslint --fix", "prettier --write"],
    "*.{json,md,yml,css}": ["prettier --write"]
  }
```

## ğŸš€ å®Œæ•´å·¥ä½œæµç¨‹

### é˜¶æ®µ1ï¼šæœ¬åœ°å¼€å‘

#### 1.1 å¯åŠ¨å¼€å‘ç¯å¢ƒ

```bash
# æ¨èæ–¹å¼ï¼šåŒæ—¶å¯åŠ¨å¼€å‘æœåŠ¡å™¨å’ŒESLintå®æ—¶ç›‘æ§
npm run dev:lint

# æˆ–è€…åˆ†åˆ«å¯åŠ¨
npm run dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run lint:watch   # å¯åŠ¨ESLintå®æ—¶ç›‘æ§
```

#### 1.2 ç¼–ç è¿‡ç¨‹ä¸­çš„å®æ—¶æç¤º

- **VS Codeé›†æˆ**: å®‰è£…ESLintæ‰©å±•è·å¾—å®æ—¶æç¤º
- **ç¼–è¾‘å™¨æç¤º**:
  - ğŸ”´ çº¢è‰²æ³¢æµªçº¿ï¼šè¯­æ³•é”™è¯¯
  - ğŸŸ¡ é»„è‰²æ³¢æµªçº¿ï¼šä»£ç è§„èŒƒè­¦å‘Š
  - ğŸ’¡ ç¯æ³¡å›¾æ ‡ï¼šè‡ªåŠ¨ä¿®å¤å»ºè®®

#### 1.3 ä¿å­˜æ—¶è‡ªåŠ¨å¤„ç†

- **è‡ªåŠ¨æ ¼å¼åŒ–** - Prettierè‡ªåŠ¨æ ¼å¼åŒ–ä»£ç 
- **è‡ªåŠ¨ä¿®å¤** - ESLintä¿®å¤å¯ä¿®å¤çš„é—®é¢˜
- **å®æ—¶æ£€æŸ¥** - å³æ—¶æ˜¾ç¤ºä»£ç è´¨é‡é—®é¢˜

### é˜¶æ®µ2ï¼šæš‚å­˜æ–‡ä»¶å‡†å¤‡

#### 2.1 æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº

```bash
# æ·»åŠ ç‰¹å®šæ–‡ä»¶
git add src/utils/dataConsistency.ts

# æ·»åŠ æ‰€æœ‰å˜æ›´æ–‡ä»¶
git add .

# æ·»åŠ ç‰¹å®šç±»å‹çš„æ–‡ä»¶
git add src/**/*.ts
```

#### 2.2 lint-staged è‡ªåŠ¨æ£€æŸ¥

å½“æ‰§è¡Œ `git add` æ—¶ï¼Œlint-stagedè‡ªåŠ¨æ‰§è¡Œï¼š

```bash
# å¯¹æš‚å­˜çš„ .ts/.js æ–‡ä»¶æ‰§è¡Œ
eslint --fix          # ESLintè‡ªåŠ¨ä¿®å¤
prettier --write      # Prettieræ ¼å¼åŒ–

# å¯¹æš‚å­˜çš„ .json/.md/.yml æ–‡ä»¶æ‰§è¡Œ
prettier --write      # ä»…æ ¼å¼åŒ–
```

### é˜¶æ®µ3ï¼šæäº¤éªŒè¯

#### 3.1 æäº¤ä¿¡æ¯éªŒè¯

```bash
# æ­£ç¡®æ ¼å¼çš„æäº¤ä¿¡æ¯
git commit -m "feat: æ·»åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½"

# é”™è¯¯æ ¼å¼ä¼šè¢«é˜»æ­¢
git commit -m "æ·»åŠ ç”¨æˆ·åŠŸèƒ½"  # âŒ ä¼šå¤±è´¥
```

#### 3.2 æäº¤ä¿¡æ¯è§„èŒƒ

**æ ¼å¼**: `<type>(<scope>): <subject>`

**ç±»å‹ (type)**:

- `feat` - æ–°åŠŸèƒ½
- `fix` - ä¿®å¤bug
- `docs` - æ–‡æ¡£æ›´æ–°
- `style` - ä»£ç æ ¼å¼
- `refactor` - ä»£ç é‡æ„
- `test` - æµ‹è¯•ç›¸å…³
- `chore` - æ„å»º/å·¥å…·é…ç½®
- `perf` - æ€§èƒ½ä¼˜åŒ–
- `ci` - CI/CDç›¸å…³

**ç¤ºä¾‹**:

```bash
feat(auth): æ·»åŠ JWTç”¨æˆ·è®¤è¯
fix(api): ä¿®å¤ç”¨æˆ·æ³¨å†Œæ¥å£é”™è¯¯
docs(readme): æ›´æ–°å®‰è£…è¯´æ˜
chore(deps): æ›´æ–°ä¾èµ–åŒ…ç‰ˆæœ¬
refactor(user): é‡æ„ç”¨æˆ·æœåŠ¡æ¨¡å—
```

### é˜¶æ®µ4ï¼šå¤±è´¥å¤„ç†æµç¨‹

#### 4.1 ESLintæ£€æŸ¥å¤±è´¥

```bash
# é—®é¢˜ç¤ºä¾‹
âœ– 5 problems (2 errors, 3 warnings)

# è§£å†³æ–¹æ¡ˆ
npm run lint:fix    # è‡ªåŠ¨ä¿®å¤å¯ä¿®å¤é—®é¢˜
npm run lint        # æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
```

#### 4.2 Prettieræ ¼å¼åŒ–å¤±è´¥

```bash
# è‡ªåŠ¨ä¿®å¤
npm run format

# æ£€æŸ¥æ ¼å¼é—®é¢˜
npm run format:check
```

#### 4.3 æäº¤ä¿¡æ¯æ ¼å¼é”™è¯¯

```bash
# é”™è¯¯ç¤ºä¾‹
â§— input: æ·»åŠ ç”¨æˆ·åŠŸèƒ½
âœ– subject may not be empty [subject-empty]
âœ– type may not be empty [type-empty]

# è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨æ­£ç¡®æ ¼å¼é‡æ–°æäº¤
git commit -m "feat: æ·»åŠ ç”¨æˆ·åŠŸèƒ½"
```

## ğŸ“Š è´¨é‡ä¿è¯æ£€æŸ¥

### 5.1 æ‰‹åŠ¨è´¨é‡æ£€æŸ¥å‘½ä»¤

```bash
# ä»£ç è§„èŒƒæ£€æŸ¥
npm run lint

# ä»£ç æ ¼å¼åŒ–æ£€æŸ¥
npm run format:check

# å®Œæ•´è´¨é‡æ£€æŸ¥
npm run quality

# è‡ªåŠ¨ä¿®å¤æ‰€æœ‰é—®é¢˜
npm run quality:fix
```

### 5.2 å®æ—¶ç›‘æ§å‘½ä»¤

```bash
# ESLintå®æ—¶ç›‘æ§æ–‡ä»¶å˜åŒ–
npm run lint:watch

# å¼€å‘æ¨¡å¼ + å®æ—¶æ£€æŸ¥
npm run dev:lint
```

## ğŸ”„ å›¢é˜Ÿåä½œæµç¨‹

### 6.1 æ–°æˆå‘˜å…¥èŒæµç¨‹

1. **å…‹éš†é¡¹ç›®**

   ```bash
   git clone <repository-url>
   cd project-name
   ```

2. **å®‰è£…ä¾èµ–**

   ```bash
   npm install
   ```

3. **å®‰è£…Git Hooks**

   ```bash
   npm run prepare  # æˆ– npx husky install
   ```

4. **å®‰è£…æ¨èæ‰©å±•**
   - æ‰“å¼€VS Code
   - æŸ¥çœ‹ `.vscode/extensions.json` æ¨èæ‰©å±•åˆ—è¡¨
   - å®‰è£…ESLintå’ŒPrettieræ‰©å±•

### 6.2 æ—¥å¸¸å¼€å‘å·¥ä½œæµ

```bash
# 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/user-auth

# 2. å¼€å‘åŠŸèƒ½ï¼ˆäº«å—å®æ—¶æç¤ºï¼‰
# ... ç¼–ç è¿‡ç¨‹ä¸­ ...

# 3. ä¿å­˜æ–‡ä»¶ï¼ˆè‡ªåŠ¨æ ¼å¼åŒ–+æ£€æŸ¥ï¼‰
# ... ä¿å­˜æ“ä½œè‡ªåŠ¨è§¦å‘ ...

# 4. æäº¤å‰æ£€æŸ¥
npm run quality

# 5. æ·»åŠ æ–‡ä»¶
git add .

# 6. æäº¤ï¼ˆè‡ªåŠ¨éªŒè¯ï¼‰
git commit -m "feat: å®ç°ç”¨æˆ·è®¤è¯åŠŸèƒ½"

# 7. æ¨é€åˆ†æ”¯
git push origin feature/user-auth

# 8. åˆ›å»ºPull Request
# ... åœ¨GitHub/GitLabåˆ›å»ºPR ...
```

## ğŸš¨ æ•…éšœæ’é™¤

### 7.1 å¸¸è§é—®é¢˜

#### é—®é¢˜1ï¼šESLintæ‰©å±•ä¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**:

1. æ£€æŸ¥æ˜¯å¦å®‰è£…äº†ESLintæ‰©å±•
2. é‡å¯VS Code
3. æ£€æŸ¥ `.vscode/settings.json` é…ç½®

#### é—®é¢˜2ï¼šGit Hooksä¸æ‰§è¡Œ

**è§£å†³æ–¹æ¡ˆ**:

```bash
# é‡æ–°å®‰è£…husky
npm run prepare

# æˆ–æ‰‹åŠ¨å®‰è£…
npx husky install

# æ£€æŸ¥hookæ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la .husky/
```

#### é—®é¢˜3ï¼šæäº¤è¢«é˜»æ­¢ä½†ä¸æ¸…æ¥šåŸå› 

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
npm run lint
npm run format:check

# æŸ¥çœ‹commitlinté”™è¯¯
echo "é”™è¯¯æäº¤ä¿¡æ¯" | npx commitlint
```

### 7.2 ç»•è¿‡æ£€æŸ¥ï¼ˆç´§æ€¥æƒ…å†µï¼‰

```bash
# ç»•è¿‡pre-commitæ£€æŸ¥ï¼ˆä¸æ¨èï¼‰
git commit --no-verify -m "emergency fix"

# ç»•è¿‡commit-msgæ£€æŸ¥ï¼ˆä¸æ¨èï¼‰
HUSKY=0 git commit -m "fix: emergency"
```

## ğŸ“ˆ æ•ˆç›Šæ€»ç»“

### 8.1 å¼€å‘æ•ˆç‡æå‡

- âœ… **å®æ—¶æç¤º** - ç«‹å³å‘ç°å’Œä¿®å¤é—®é¢˜
- âœ… **è‡ªåŠ¨æ ¼å¼åŒ–** - å‡å°‘æ‰‹åŠ¨æ ¼å¼åŒ–æ—¶é—´
- âœ… **è‡ªåŠ¨ä¿®å¤** - ä¸€é”®ä¿®å¤å¸¸è§é—®é¢˜
- âœ… **å¿«é€Ÿæäº¤** - éªŒè¯æµç¨‹è‡ªåŠ¨åŒ–

### 8.2 ä»£ç è´¨é‡ä¿è¯

- âœ… **ç»Ÿä¸€è§„èŒƒ** - å›¢é˜Ÿä»£ç é£æ ¼ä¸€è‡´
- âœ… **å‡å°‘Bug** - ESLintæå‰å‘ç°æ½œåœ¨é—®é¢˜
- âœ… **ç±»å‹å®‰å…¨** - TypeScriptç¡®ä¿ç±»å‹æ­£ç¡®
- âœ… **æäº¤å¯è¯»** - è§„èŒƒçš„æäº¤ä¿¡æ¯

### 8.3 å›¢é˜Ÿåä½œæ”¹å–„

- âœ… **é™ä½æ²Ÿé€šæˆæœ¬** - è‡ªåŠ¨åŒ–æ£€æŸ¥å‡å°‘ä»£ç å®¡æŸ¥æ—¶é—´
- âœ… **æ–°äººå‹å¥½** - æ˜ç¡®çš„è§„èŒƒå’Œå·¥å…·æŒ‡å¯¼
- âœ… **å¯ç»´æŠ¤æ€§** - ä¸€è‡´çš„ä»£ç ç»“æ„
- âœ… **CI/CDé›†æˆ** - ä¸ºè‡ªåŠ¨åŒ–éƒ¨ç½²åšå¥½å‡†å¤‡

## ğŸ¯ æœ€ä½³å®è·µå»ºè®®

### 9.1 æ—¥å¸¸å¼€å‘å»ºè®®

1. **å¼€å¯å®æ—¶æç¤º** - ç«‹å³çœ‹åˆ°é—®é¢˜ï¼Œç«‹å³ä¿®å¤
2. **å®šæœŸè¿è¡Œå®Œæ•´æ£€æŸ¥** - `npm run quality`
3. **ä¿æŒæäº¤åŸå­æ€§** - ä¸€ä¸ªåŠŸèƒ½ä¸€ä¸ªæäº¤
4. **ç¼–å†™æ¸…æ™°æäº¤ä¿¡æ¯** - ä¾¿äºä»£ç å®¡æŸ¥å’Œå†å²è¿½è¸ª

### 9.2 å›¢é˜Ÿè§„èŒƒå»ºè®®

1. **ç»Ÿä¸€å¼€å‘ç¯å¢ƒ** - ä½¿ç”¨ç›¸åŒçš„VS Codeé…ç½®
2. **å®šæœŸæ›´æ–°è§„åˆ™** - è·Ÿéšæœ€ä½³å®è·µæ¼”è¿›
3. **åŸ¹è®­æ–°æˆå‘˜** - ç†Ÿæ‚‰å·¥ä½œæµç¨‹å’Œå·¥å…·ä½¿ç”¨
4. **ç›‘æ§è´¨é‡æŒ‡æ ‡** - è·Ÿè¸ªä»£ç è´¨é‡å’Œæäº¤é¢‘ç‡

### 9.3 æŒç»­æ”¹è¿›å»ºè®®

1. **æ”¶é›†åé¦ˆ** - å®šæœŸæ”¶é›†å›¢é˜Ÿä½¿ç”¨åé¦ˆ
2. **è°ƒæ•´è§„åˆ™** - æ ¹æ®é¡¹ç›®ç‰¹ç‚¹ä¼˜åŒ–é…ç½®
3. **å·¥å…·å‡çº§** - ä¿æŒä¾èµ–åŒ…æœ€æ–°ç‰ˆæœ¬
4. **æµç¨‹ä¼˜åŒ–** - æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å·¥ä½œæµç¨‹

---

**æ€»ç»“**: è¿™å¥—å·¥ç¨‹åŒ–å·¥ä½œæµç¨‹å°†åŸæœ¬ç®€å•çš„ä»£ç æäº¤è§„èŒƒåŒ–ä¸ºå®Œæ•´çš„è´¨é‡ä¿è¯ä½“ç³»ï¼Œç¡®ä¿æ¯æ¬¡æäº¤éƒ½ç¬¦åˆé«˜æ ‡å‡†ï¼Œæå‡å›¢é˜Ÿå¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚
